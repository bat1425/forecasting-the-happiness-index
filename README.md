# Прогнозирование Индекса Счастья Городов

Этот проект направлен на предсказание **индекса счастья** (`Happiness_Score`) городов на основе социально-экологических и экономических показателей. Использованы методы машинного обучения, такие как линейная регрессия, случайный лес и градиентный бустинг (XGBoost), а также инструменты визуализации и анализа данных.

## Структура проекта

* `train.csv` — тренировочный набор данных с известным `Happiness_Score`
* `test.csv` — тестовый набор данных без целевой переменной
* `submission.csv` — файл с предсказанными значениями `Happiness_Score` для `test.csv`
* `notebook.ipynb` или `main.py` — основной код проекта (EDA, препроцессинг, обучение моделей, визуализация)
* `README.md` — описание проекта

## Описание данных

Каждая строка представляет данные о городе в конкретном месяце и году. Признаки включают:

| Признак                | Описание                                 |
| ---------------------- | ---------------------------------------- |
| `City`                 | Название города                          |
| `Month`                | Месяц наблюдения                         |
| `Year`                 | Год наблюдения                           |
| `Decibel_Level`        | Средний уровень шума                     |
| `Traffic_Density`      | Категориальный признак плотности трафика |
| `Green_Space_Area`     | Площадь зелёных зон (в условных ед.)     |
| `Air_Quality_Index`    | Индекс качества воздуха                  |
| `Cost_of_Living_Index` | Индекс стоимости жизни                   |
| `Healthcare_Index`     | Индекс доступности медицины              |
| `Happiness_Score`      | Целевая переменная (только в train.csv)  |

## Анализ данных

* **Корреляция:**

  * `Green_Space_Area` и `Happiness_Score`: **-0.995**
  * `Year`: **-0.981**
  * `Cost_of_Living_Index`: **+0.460**
  * Распределение `Happiness_Score` сильно смещено в отрицательную сторону.

* **Визуализация:**

  * Матрица корреляции
  * Гистограмма распределения `Happiness_Score`

## Предобработка

* Использован `OneHotEncoder` для категориальных признаков: `City`, `Month`, `Traffic_Density`
* Остальные признаки оставлены без изменений
* Все данные приведены к числовому формату с помощью `ColumnTransformer`

## Обучение моделей

### Использованные алгоритмы:

| Модель            | MAE   | RMSE  | R²      |
| ----------------- | ----- | ----- | ------- |
| Linear Regression | 0.978 | 2.068 | 0.998   |
| Random Forest     | 0.212 | 0.280 | \~1.000 |
| XGBoost           | 0.321 | 0.406 | \~1.000 |

> **Лучшей моделью** признан **Random Forest Regressor**, показавший минимальные ошибки и максимальную объясняющую способность (R² ≈ 1.0).

### Метрики:

* **MAE** (средняя абсолютная ошибка)
* **RMSE** (корень из среднеквадратичной ошибки)
* **R²** (коэффициент детерминации)

## Важность признаков

Наиболее значимые признаки по результатам Random Forest:

1. `Green_Space_Area`
2. `Year`
3. `Cost_of_Living_Index`
4. `Air_Quality_Index`
5. `Decibel_Level`

Город, месяц и трафик вносили небольшой вклад.

## Предсказания

После выбора лучшей модели выполнено предсказание `Happiness_Score` для тестового набора и сохранено в файл `submission.csv`.

```csv
City,Month,Year,...,Predicted_Happiness_Score
New York,January,2023,...,-41.812
Paris,March,2023,...,-44.652
...
```

## Используемые библиотеки

* `pandas`, `numpy`, `matplotlib`, `seaborn`
* `scikit-learn` (регрессоры, предобработка, метрики)
* `xgboost`

## Возможные улучшения

* Настройка гиперпараметров моделей
* Регуляризация для борьбы с переобучением
* Дополнительный анализ выбросов и трансформация целевой переменной
* Применение к другим городским/социальным метрикам

## Лицензия

Этот проект предоставляется в учебных и исследовательских целях.

---

Если нужно, могу добавить версию на английском или генерацию `requirements.txt`.
